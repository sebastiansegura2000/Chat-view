<body>

  <br><br>

  <h1>
    <b>Messages</b>
    <br><br>
    <div class="btn-group" role="group" aria-label="Basic example">
      <a routerLink="/chat-def" routerLinkActive="active" class="btn btn-secondary">
        <i class="fa-solid fa-backward"></i> Come back
      </a>
      <button (click)="showReceiverMessages()" class="btn btn-secondary">Receiver Messages</button>
      <button (click)="showGroupMessages()" class="btn btn-secondary">Group Messages</button>
    </div>
  </h1>
  <br>

  <div class="mb-3 d-flex justify-content-center">
    <div style="max-width: 300px;">
      <label for="filterInput" class="form-label">Filter:</label>
      <div class="input-group input-group-sm">
        <select class="form-select" [(ngModel)]="selectedFilterField">
          <option value="sender">Sender</option>
          <option value="receiverOrGroup">Receiver/Group</option>
          <option value="message">Message</option>
        </select>
        <input type="text" class="form-control" id="filterInput" [(ngModel)]="filterValue" placeholder="Type here to filter" (keyup.enter)="applyFilter()">
        <button class="btn btn-primary" (click)="applyFilter()">Search</button>
      </div>
    </div>
  </div>

  <br>

  <div *ngIf="showReceiver">
    <h2>Receiver Messages</h2>
    <table class="container">
      <thead>
          <tr>
              <th><h1>#</h1></th>
              <th><h1>Sender</h1></th>
              <th><h1>Receiver</h1></th>
              <th><h1>Message</h1></th>
              <th><h1>Read</h1></th>
              <th><h1>Timestamps</h1></th>
          </tr>
      </thead>
      <tbody>
          <tr *ngFor="let message of userMessages">
              <td>{{ message.id }}</td>
              <td>{{ message.sender_name }}</td>
              <td>{{ message.recipient_name}}</td>
              <td>{{ message.content}}</td>
              <td>{{ (message.read.length != 0) ? 'yes' : 'no' }}</td>
              <td>{{ message.created_at }}</td>
          </tr>
      </tbody>
    </table>
  </div>

  <div *ngIf="showGroup">
    <h2>Group Messages</h2>
    <table class="container">
      <thead>
          <tr>
              <th><h1>#</h1></th>
              <th><h1>Sender</h1></th>
              <th><h1>Group</h1></th>
              <th><h1>Message</h1></th>
              <th><h1>Timestamps</h1></th>
          </tr>
      </thead>
      <tbody>
        <tr *ngFor="let message of groupMessages">
          <td>{{ message.id }}</td>
          <td>{{ message.sender_name }}</td>
          <td>{{ message.group_name}}</td>
          <td>{{ message.content}}</td>
          <td>{{ message.created_at }}</td>
      </tr>
      </tbody>
    </table>
  </div>
  <br>
</body>

<!-- <p>message-history works!</p> -->
